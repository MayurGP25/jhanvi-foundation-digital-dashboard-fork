<!DOCTYPE html>
<html lang="en">
<head>
    <title>Login ‚Äì Jhanavi Foundation Dashboard</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link href="/css/styles.css" rel="stylesheet" />

    <style>
        body {
            min-height: 100vh;
            margin: 0;
            background:
                radial-gradient(circle at top left, #e3f2fd 0, #f5f7fb 40%, #ffffff 100%);
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }
        .auth-shell {
            min-height: 100vh;
            display: flex;
            align-items: center;
        }
        .auth-card {
            border-radius: 24px;
            border: 1px solid rgba(148, 163, 184, 0.35);
            box-shadow: 0 18px 45px rgba(15, 23, 42, 0.18);
        }
        .brand-mark {
            font-weight: 700;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            font-size: 0.8rem;
        }
        .brand-sub {
            font-size: 0.78rem;
            color: #9ca3af;
        }
        .auth-title {
            font-size: 1.5rem;
        }
        .form-label {
            font-size: 0.9rem;
            font-weight: 500;
        }
        .form-control {
            border-radius: 999px;
            padding: 0.55rem 1.1rem;
        }
        .btn-rounded {
            border-radius: 999px;
        }
        .text-link {
            font-size: 0.85rem;
        }
        .auth-side {
            color: #0f172a;
        }
        .auth-side-card {
            background: linear-gradient(135deg, #0f172a, #1f2937);
            border-radius: 24px;
            padding: 1.75rem;
            color: #e5e7eb;
            box-shadow: 0 20px 55px rgba(15, 23, 42, 0.7);
        }
        .auth-chip {
            font-size: 0.78rem;
            border-radius: 999px;
            padding: 0.25rem 0.75rem;
            background: rgba(15, 23, 42, 0.7);
        }
        .auth-metric {
            font-size: 0.8rem;
            color: #9ca3af;
        }
        .auth-value {
            font-size: 1.1rem;
            font-weight: 600;
        }
    </style>
</head>
<body>
<div class="auth-shell">
    <div class="container">
        <div class="row justify-content-center align-items-center gy-4">
            <!-- Illustration / Value Prop -->
            <div class="col-lg-6 d-none d-lg-block auth-side">
                <div class="mb-3">
                    <div class="brand-mark">JHANAVI FOUNDATION</div>
                    <div class="brand-sub">Digital Dashboard</div>
                </div>
                <div class="auth-side-card">
                    <span class="auth-chip mb-3 d-inline-flex align-items-center gap-1">
                        <span>üîê</span> Secure admin access
                    </span>
                    <h3 class="mb-3">Operate with confidence & traceability.</h3>
                    <p class="mb-4 small text-gray-300">
                        Every login is protected, and every action you take in the dashboard helps maintain
                        clean, auditable data for your programs and partners.
                    </p>

                    <div class="row g-3">
                        <div class="col-6">
                            <div class="border rounded-3 border-slate-600 p-2 px-3">
                                <div class="auth-metric">Access role</div>
                                <div class="auth-value">Admin / Staff</div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="border rounded-3 border-slate-600 p-2 px-3">
                                <div class="auth-metric">Module coverage</div>
                                <div class="auth-value">3 core modules</div>
                            </div>
                        </div>
                        <div class="col-12 mt-2">
                            <div class="small text-gray-400">
                                Use your registered email and password to sign in. Contact your administrator
                                if you need access or have forgotten your credentials.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Login Form -->
            <div class="col-12 col-lg-5">
                <div class="card auth-card p-4 p-md-5">
                    <div class="mb-3 d-flex justify-content-between align-items-center">
                        <div>
                            <h2 class="auth-title fw-semibold mb-1">Sign in to Dashboard</h2>
                            <p class="text-muted small mb-0">
                                Enter your credentials to access the NGO operations hub.
                            </p>
                        </div>
                        <a href="/" class="text-decoration-none small text-muted">
                            ‚Üê Back
                        </a>
                    </div>

                    <% if (typeof message !== 'undefined' && message) { %>
                        <div class="alert alert-<%= type || 'danger' %> mb-3" role="alert">
                            <%= message %>
                        </div>
                    <% } %>

                    <form action="/login" method="POST" novalidate>
                        <div class="mb-3">
                            <label class="form-label">Email</label>
                            <input
                              type="email"
                              class="form-control"
                              name="email"
                              placeholder="you@ngo.org"
                              required
                            >
                        </div>

                        <div class="mb-2">
                            <label class="form-label d-flex justify-content-between">
                                <span>Password</span>
                                <a href="#" class="text-link" data-bs-toggle="modal" data-bs-target="#forgotModal">
                                    Forgot password?
                                </a>
                            </label>
                            <input
                              type="password"
                              class="form-control"
                              name="password"
                              placeholder="Enter your password"
                              required
                            >
                        </div>

                        <button class="btn btn-primary w-100 btn-rounded mt-3">
                            Login
                        </button>

                        <div class="mt-3 d-flex justify-content-between align-items-center text-link">
                            <span>Don‚Äôt have an account?</span>
                            <a href="/signup">Create admin account</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Forgot Password Modal (unchanged logic, improved styling only) -->
<div class="modal fade" id="forgotModal" tabindex="-1" aria-labelledby="forgotModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="forgotModalLabel">Reset Password</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="forgotForm" action="/forgot-direct" method="POST" novalidate>
        <div class="modal-body">
          <div id="forgotErrors" class="alert alert-danger d-none" role="alert"></div>
          <div class="mb-3">
            <label class="form-label">Email</label>
            <input type="email" class="form-control" name="email" id="forgotEmail" required>
          </div>
          <div class="mb-3">
            <label class="form-label">New Password</label>
            <input
              type="password"
              class="form-control"
              name="password"
              id="forgotPassword"
              pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&]).{8,}"
              title="Password must contain at least 1 uppercase, 1 lowercase, 1 digit, 1 special character and be 8+ characters long."
              minlength="8"
              required
            >
          </div>
          <div class="mb-3">
            <label class="form-label">Confirm Password</label>
            <input
              type="password"
              class="form-control"
              name="confirmPassword"
              id="forgotConfirm"
              minlength="8"
              required
            >
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary btn-sm" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary btn-sm">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  (function() {
    const form = document.getElementById('forgotForm');
    const errorsBox = document.getElementById('forgotErrors');
    const emailEl = document.getElementById('forgotEmail');
    const passEl = document.getElementById('forgotPassword');
    const confirmEl = document.getElementById('forgotConfirm');

    function validatePasswordRules(pwd) {
      const re = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&]).{8,}$/;
      return re.test(pwd);
    }

    form.addEventListener('submit', function(e) {
      const errors = [];
      const email = emailEl.value.trim();
      const pwd = passEl.value;
      const confirm = confirmEl.value;

      if (!email || !pwd || !confirm) {
        errors.push('All fields are required.');
      }
      if (pwd !== confirm) {
        errors.push('Passwords do not match.');
      }
      if (pwd && !validatePasswordRules(pwd)) {
        errors.push('Password must contain at least 1 uppercase, 1 lowercase, 1 digit, 1 special character and be 8+ characters long.');
      }

      if (errors.length > 0) {
        e.preventDefault();
        errorsBox.classList.remove('d-none');
        errorsBox.innerHTML = errors.map(x => `<div>${x}</div>`).join('');
        const modal = bootstrap.Modal.getOrCreateInstance(document.getElementById('forgotModal'));
        modal.show();
      } else {
        errorsBox.classList.add('d-none');
        errorsBox.innerHTML = '';
      }
    });
  })();
</script>
</body>
</html>